<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.bzs.dao.ThirdInsuranceAccountInfoMapper">
  <resultMap id="BaseResultMap" type="com.bzs.model.ThirdInsuranceAccountInfo">
    <!--
      WARNING - @mbg.generated
    -->
    <id column="third_insurance_id" jdbcType="VARCHAR" property="thirdInsuranceId" />
    <result column="create_id" jdbcType="VARCHAR" property="createId" />
    <result column="account_name" jdbcType="VARCHAR" property="accountName" />
    <result column="account_pwd" jdbcType="VARCHAR" property="accountPwd" />
    <result column="create_time" jdbcType="TIMESTAMP" property="createTime" />
    <result column="update_time" jdbcType="TIMESTAMP" property="updateTime" />
    <result column="vpn" jdbcType="VARCHAR" property="vpn" />
    <result column="account_id" jdbcType="VARCHAR" property="accountId" />
    <result column="is_pay" jdbcType="VARCHAR" property="isPay" />
    <result column="account_type" jdbcType="VARCHAR" property="accountType" />
    <result column="ip" jdbcType="VARCHAR" property="ip" />
    <result column="port" jdbcType="VARCHAR" property="port" />
    <result column="status" jdbcType="VARCHAR" property="status" />
    <result column="enable_start_date" jdbcType="VARCHAR" property="enableStartDate" />
    <result column="enable_end_date" jdbcType="VARCHAR" property="enableEndDate" />
  </resultMap>



<!--根据账号id修改  开始-->
  <sql id="updateItems">
    <trim prefix="Set" suffixOverrides=",">
      <if test="accountName!=null and accountName!=''"> account_name=#{accountName},</if>
      <if test="accountPwd!=null and accountPwd!=''"> account_pwd=#{accountPwd},</if>
      <if test="vpn!=null and vpn!=''"> vpn=#{vpn},</if>
      <if test="isPay!=null and isPay!=''"> is_pay=#{isPay},</if>
      <if test="accountType!=null and accountType!=''">account_type=#{accountType},</if>
      <if test="ip!=null and ip!=''"> ip=#{ip},</if>
      <if test="status!=null and status!=''">status=#{status},</if>
      <if test="enableStartDate!=null and enableStartDate!=''"> enable_start_date=#{enableStartDate},</if>
      <if test="enableEndDate!=null and enableEndDate!=''"> enable_end_date=#{enableEndDate},</if>
    </trim>
  </sql>
  <update id="updateById" parameterType="com.bzs.model.ThirdInsuranceAccountInfo">
    update third_insurance_account_info <include refid="updateItems"/> where  third_insurance_id=#{thirdInsuranceId}
  </update>
  <!--根据账号id修改  结束-->
  <!--根据条件查询  开始-->
  <sql id="queryConditions">
    <trim prefix="where" prefixOverrides="where" suffixOverrides="and">
      <if test="thirdInsuranceId!=null and thirdInsuranceId!=''"> third_insurance_id=#{thirdInsuranceId} and </if>
      <if test="createId!=null and createId!=''"> create_id=#{createId} and </if>
      <if test="accountId!=null and accountId!=''"> account_id=#{accountId} and </if>
      <if test="status!=null and status!=''"> status=#{status} and </if>
      <if test="accountType!=null and accountType!=''"> account_type=#{accountType} and </if>
      <if test="accountId!=null and accountId!=''"> account_id=#{accountId} and </if>
    </trim>
  </sql>
  <select id="queryConditions" parameterType="com.bzs.model.ThirdInsuranceAccountInfo" resultMap="BaseResultMap">
    select * from  third_insurance_account_info <include refid="queryConditions"/> order  by  create_time desc
  </select>
  <!--根据条件查询  结束-->
  <!--获取每个保司下可用的账号最新添加的账号 开始-->
  <select id="findDifferSourceAccount" resultMap="BaseResultMap">
    SELECT m.* FROM(select *from third_insurance_account_info WHERE account_id=#{accountId} and status=#{status} ORDER BY create_time DESC LIMIT 100)m GROUP BY m.account_type
  </select>
  <!--获取每个保司下可用的账号最新添加的账号 结束-->
  <!--修改或添加 开始-->
  <sql id="insertItems">
    <trim prefix="(" suffix=")" suffixOverrides=",">
      third_insurance_id,
      <if test="createId!=null and ''!=createId ">create_id,</if>
      <if test="accountName!=null and ''!=accountName ">account_name,</if>
      <if test="accountPwd!=null and ''!=accountPwd ">account_pwd,</if>
      <if test="createTime!=null and ''!=createTime ">create_time,</if>
      <if test="vpn!=null and ''!=vpn ">vpn,</if>
      <if test="accountId!=null and ''!=accountId ">account_id,</if>
      <if test="isPay!=null and ''!=isPay ">is_pay,</if>
      <if test="accountType!=null and ''!=accountType ">account_type,</if>
      <if test="ip!=null and ''!=ip ">ip,</if>

      <if test="port!=null and ''!=port ">port,</if>
      <if test="status!=null and ''!=status ">status,</if>
      <if test="enableStartDate!=null and ''!=enableStartDate ">enable_start_date,</if>
      <if test="enableEndDate!=null and ''!=enableEndDate ">enable_end_date,</if>
    </trim>
  </sql>

  <sql id="insertValues">
    <trim prefix="(" suffix=")" suffixOverrides=",">
      #{thirdInsuranceId},
      <if test="createId!=null and ''!=createId ">#{createId},</if>
      <if test="accountName!=null and ''!=accountName ">#{accountName},</if>
      <if test="accountPwd!=null and ''!=accountPwd ">#{accountPwd},</if>
      <if test="vpn!=null and ''!=vpn ">#{vpn},</if>
      <if test="accountId!=null and ''!=accountId ">#{accountId},</if>
      <if test="isPay!=null and ''!=isPay ">#{isPay},</if>
      <if test="accountType!=null and ''!=accountType ">#{accountType},</if>
      <if test="ip!=null and ''!=ip ">#{ip},</if>
      <if test="port!=null and ''!=port ">#{port},</if>
      <if test="status!=null and ''!=status ">#{status},</if>
      <if test="enableStartDate!=null and ''!=enableStartDate ">#{enableStartDate},</if>
      <if test="enableEndDate!=null and ''!=enableEndDate ">#{enableEndDate},</if>
    </trim>
  </sql>
  <insert id="addOrUpdate" parameterType="com.bzs.model.AccountInfo">
    insert into third_insurance_account_info <include refid="insertItems"/> values <include refid="insertValues"/>
    ON DUPLICATE KEY UPDATE
    create_id=values(create_id),
    account_name=values(account_name),
    account_pwd=values(account_pwd),
    vpn=values(vpn),
    ip=values(ip),
    port=values(port),
    status=values(status),
    enable_start_date=values(enable_start_date),
    enable_end_date=values(enable_end_date)
  </insert>

  <!--修改或添加 结束-->
</mapper>